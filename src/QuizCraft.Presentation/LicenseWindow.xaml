<ui:FluentWindow x:Class="QuizCraft.Presentation.LicenseWindow"
        xmlns="http://schemas.microsoft.com/winfx/2006/xaml/presentation"
        xmlns:x="http://schemas.microsoft.com/winfx/2006/xaml"
        xmlns:ui="http://schemas.lepo.co/wpfui/2022/xaml"
        xmlns:vm="clr-namespace:QuizCraft.Presentation.ViewModels"
        xmlns:conv="clr-namespace:QuizCraft.Presentation.Converters"
        Title="QuizCraft - Ativacao de Licenca"
        Height="580" Width="460"
        MinHeight="520" MinWidth="400"
        WindowStartupLocation="CenterScreen"
        ResizeMode="NoResize"
        ExtendsContentIntoTitleBar="True"
        Icon="/Assets/logoQuizCraft.png">

    <Window.Resources>
        <conv:NullOrEmptyToVisibilityConverter x:Key="NullOrEmptyToVis" />
        <conv:InverseBoolConverter x:Key="InverseBool" />
        <BooleanToVisibilityConverter x:Key="BoolToVis" />
    </Window.Resources>

    <Grid>
        <Grid.RowDefinitions>
            <RowDefinition Height="Auto" />
            <RowDefinition Height="*" />
        </Grid.RowDefinitions>

        <ui:TitleBar Grid.Row="0" Title="QuizCraft" ShowMinimize="False" ShowMaximize="False" />

        <Border Grid.Row="1" Padding="32">
            <StackPanel VerticalAlignment="Center" HorizontalAlignment="Center"
                        MaxWidth="360">

                <!-- Logo -->
                <Image Source="/Assets/logoQuizCraft.png"
                       Width="120" Height="120"
                       Margin="0,0,0,16"
                       RenderOptions.BitmapScalingMode="HighQuality" />

                <!-- Titulo -->
                <TextBlock Text="QuizCraft"
                           FontSize="28" FontWeight="Bold"
                           HorizontalAlignment="Center"
                           Margin="0,0,0,4" />

                <TextBlock Text="Plataforma de Estudos Inteligente"
                           FontSize="13"
                           Foreground="{ui:ThemeResource TextFillColorSecondaryBrush}"
                           HorizontalAlignment="Center"
                           Margin="0,0,0,24" />

                <!-- Separador -->
                <Border Height="1"
                        Background="{ui:ThemeResource CardStrokeColorDefaultBrush}"
                        Margin="0,0,0,24" />

                <!-- Instrucao -->
                <TextBlock Text="Ative sua licenca"
                           FontSize="16" FontWeight="SemiBold"
                           HorizontalAlignment="Center"
                           Margin="0,0,0,4" />

                <TextBlock Text="Informe o email usado na compra para ativar o app neste dispositivo."
                           FontSize="12"
                           Foreground="{ui:ThemeResource TextFillColorSecondaryBrush}"
                           TextWrapping="Wrap"
                           TextAlignment="Center"
                           HorizontalAlignment="Center"
                           Margin="0,0,0,20" />

                <!-- Campo de Email -->
                <ui:TextBox x:Name="EmailTextBox"
                            PlaceholderText="seu@email.com"
                            Text="{Binding Email, UpdateSourceTrigger=PropertyChanged}"
                            Icon="{ui:SymbolIcon Mail24}"
                            Margin="0,0,0,16"
                            FontSize="14" />

                <!-- Botao Ativar -->
                <ui:Button Content="Ativar Licenca"
                           Command="{Binding ActivateCommand}"
                           Appearance="Primary"
                           HorizontalAlignment="Stretch"
                           Height="40"
                           FontSize="14"
                           Icon="{ui:SymbolIcon Key24}"
                           IsEnabled="{Binding IsLoading, Converter={StaticResource InverseBool}}"
                           Margin="0,0,0,12" />

                <!-- Loading -->
                <StackPanel Orientation="Horizontal"
                            HorizontalAlignment="Center"
                            Visibility="{Binding IsLoading, Converter={StaticResource BoolToVis}}"
                            Margin="0,0,0,8">
                    <ui:ProgressRing Width="20" Height="20" IsIndeterminate="True" />
                    <TextBlock Text="Verificando licenca..."
                               Margin="8,0,0,0"
                               VerticalAlignment="Center"
                               Foreground="{ui:ThemeResource TextFillColorSecondaryBrush}" />
                </StackPanel>

                <!-- Mensagem de Erro -->
                <Border Background="#33FF0000" CornerRadius="6" Padding="12,8"
                        Visibility="{Binding ErrorMessage, Converter={StaticResource NullOrEmptyToVis}}"
                        Margin="0,0,0,8">
                    <TextBlock Text="{Binding ErrorMessage}"
                               Foreground="#FFFF4444"
                               TextWrapping="Wrap"
                               FontSize="12" />
                </Border>

                <!-- Mensagem de Sucesso -->
                <Border Background="#3300CC00" CornerRadius="6" Padding="12,8"
                        Visibility="{Binding SuccessMessage, Converter={StaticResource NullOrEmptyToVis}}"
                        Margin="0,0,0,8">
                    <TextBlock Text="{Binding SuccessMessage}"
                               Foreground="#FF00CC00"
                               TextWrapping="Wrap"
                               FontSize="12" />
                </Border>

                <!-- Link para compra -->
                <TextBlock HorizontalAlignment="Center" Margin="0,8,0,0" FontSize="11">
                    <Run Text="Ainda nao tem licenca? " Foreground="{ui:ThemeResource TextFillColorSecondaryBrush}" />
                    <Hyperlink NavigateUri="https://codecraftgenz.com.br" RequestNavigate="Hyperlink_RequestNavigate">
                        <Run Text="Adquira aqui" />
                    </Hyperlink>
                </TextBlock>

            </StackPanel>
        </Border>
    </Grid>
</ui:FluentWindow>
